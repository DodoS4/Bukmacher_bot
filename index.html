<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>AI Betting PRO</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.tailwindcss.com"></script>

<style>
body { background:#f8fafc; font-family: Inter, system-ui; }
.card { background:white; border-radius:1.25rem; border:1px solid #e2e8f0; }
</style>
</head>

<body class="p-4 md:p-8">
<div class="max-w-7xl mx-auto">

<!-- HEADER -->
<div class="card p-5 mb-8 flex justify-between">
  <div>
    <h1 class="text-2xl font-black italic">AI BETTING <span class="text-blue-600">PRO</span></h1>
    <p id="sync" class="text-xs text-slate-400 font-bold">Syncâ€¦</p>
  </div>
</div>

<!-- OSTATNIE MECZE -->
<div class="card p-6 mb-8">
  <h3 class="text-xs font-black uppercase text-slate-400 mb-4">Ostatnie mecze</h3>
  <div id="recent" class="space-y-2"></div>
</div>

<!-- LIGI -->
<div class="card p-6 mb-6">
  <h3 class="text-xs font-black uppercase text-slate-400 mb-4">Wyniki wg lig</h3>
  <div id="leagues" class="grid grid-cols-2 md:grid-cols-4 gap-4"></div>
</div>

<!-- SZCZEGÃ“ÅY LIGI -->
<div id="leagueDetails" class="hidden"></div>

</div>

<script>
let HISTORY = [];

const ICONS = {
  icehockey: "ðŸ’",
  soccer: "âš½",
  basketball: "ðŸ€",
  tennis: "ðŸŽ¾"
};

function iconFor(league){
  for (let k in ICONS) if (league.includes(k)) return ICONS[k];
  return "ðŸŽ¯";
}

async function load(){
  const t='?'+Date.now();
  const h=await fetch('history.json'+t).then(r=>r.json());
  const s=await fetch('stats.json'+t).then(r=>r.json());
  HISTORY=h;
  document.getElementById('sync').innerText="Sync: "+(s.last_sync||'now');
  renderRecent();
  renderLeagues();
}

function renderRecent(){
  const el=document.getElementById('recent');
  el.innerHTML=[...HISTORY].reverse().slice(0,10).map(m=>{
    const d=new Date(m.time);
    return `
    <div class="flex justify-between text-xs p-3 rounded-lg ${m.profit>=0?'bg-green-50':'bg-red-50'}">
      <div>
        <b>${m.home} â€“ ${m.away}</b><br>
        <span class="text-slate-400">
          ${d.toLocaleDateString()} ${d.toLocaleTimeString().slice(0,5)}
          | stawka ${m.stake} | @${m.odds}
        </span>
      </div>
      <b class="${m.profit>=0?'text-green-600':'text-red-600'}">
        ${m.profit>=0?'+':''}${m.profit}
      </b>
    </div>`;
  }).join('');
}

function renderLeagues(){
  const map={};
  HISTORY.forEach(m=>{
    if(!map[m.sport]) map[m.sport]={profit:0,list:[]};
    map[m.sport].profit+=m.profit;
    map[m.sport].list.push(m);
  });

  const el=document.getElementById('leagues');
  el.innerHTML=Object.entries(map)
    .sort((a,b)=>b[1].profit-a[1].profit)
    .map(([k,v])=>`
    <div onclick="openLeague('${k}')"
      class="cursor-pointer p-4 rounded-xl bg-slate-50 hover:shadow">
      <div class="flex justify-between">
        <span>${iconFor(k)}</span>
        <b class="${v.profit>=0?'text-green-600':'text-red-600'}">
          ${v.profit.toFixed(2)} PLN
        </b>
      </div>
      <p class="text-[10px] font-bold uppercase text-slate-500 mt-1">
        ${k.replaceAll('_',' ')} (${v.list.length})
      </p>
    </div>
  `).join('');
}

function openLeague(key){
  const list=HISTORY.filter(m=>m.sport===key);
  document.getElementById('leagueDetails').classList.remove('hidden');
  document.getElementById('leagueDetails').innerHTML=`
  <div class="card p-6 mt-6">
    <h3 class="font-black mb-4">${key.replaceAll('_',' ')}</h3>
    ${list.map(m=>{
      const d=new Date(m.time);
      return `
      <div class="border-b py-2 text-xs">
        <div class="flex justify-between">
          <span>
            ${d.toLocaleDateString()} ${d.toLocaleTimeString().slice(0,5)}
            | <b class="text-green-600">${m.winner||'-'}</b>
          </span>
          <b class="${m.profit>=0?'text-green-600':'text-red-600'}">
            ${m.profit>=0?'+':''}${m.profit}
          </b>
        </div>
        <div class="flex justify-between text-slate-500">
          <span>${m.home} â€“ ${m.away}</span>
          <span>stawka ${m.stake} | @${m.odds}</span>
        </div>
      </div>`;
    }).join('')}
  </div>`;
}

load();
</script>
</body>
</html>
