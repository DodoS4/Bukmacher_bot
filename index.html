<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Betting PRO Dashboard</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body { background:#f8fafc; font-family:Inter,system-ui }
.card { background:white; border-radius:1.5rem; padding:1.5rem; border:1px solid #e5e7eb }
</style>
</head>

<body class="p-6">
<div class="max-w-7xl mx-auto space-y-8">

<!-- HEADER -->
<div class="flex justify-between items-center card">
  <div>
    <h1 class="text-2xl font-black italic">AI BETTING <span class="text-blue-600">PRO</span></h1>
    <p id="sync" class="text-[10px] text-slate-400 font-bold uppercase">Sync...</p>
  </div>
  <div class="bg-blue-600 text-white px-4 py-2 rounded-xl text-xs font-black">
    LIVE
  </div>
</div>

<!-- STATS -->
<div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4">
  <div class="card"><p class="text-[10px] uppercase text-slate-400 font-black">Zysk 24h</p><p id="p24" class="text-xl font-black">0</p></div>
  <div class="card ring-2 ring-blue-200"><p class="text-[10px] uppercase text-blue-600 font-black">Zysk total</p><p id="pt" class="text-xl font-black text-blue-600">0</p></div>
  <div class="card ring-2 ring-purple-200"><p class="text-[10px] uppercase text-purple-600 font-black">Bankroll</p><p id="br" class="text-xl font-black text-purple-600">0</p></div>
  <div class="card"><p class="text-[10px] uppercase text-slate-400 font-black">Obr√≥t</p><p id="turn" class="text-xl font-black">0</p></div>
  <div class="card bg-amber-50"><p class="text-[10px] uppercase text-amber-600 font-black">W grze</p><p id="active" class="text-xl font-black text-amber-700">0</p></div>
  <div class="card"><p class="text-[10px] uppercase text-orange-500 font-black">Yield</p><p id="yield" class="text-xl font-black text-orange-600">0%</p></div>
  <div class="card"><p class="text-[10px] uppercase text-slate-400 font-black">Kupony</p><p id="count" class="text-xl font-black">0</p></div>
</div>

<!-- CHART -->
<div class="card">
  <h3 class="text-xs font-black uppercase text-slate-400 mb-4">Progresja bankrolla</h3>
  <div class="h-[300px]">
    <canvas id="chart"></canvas>
  </div>
</div>

<!-- RECENT MATCHES -->
<div class="card">
<h3 class="text-xs font-black uppercase text-slate-400 mb-4">Ostatnie mecze</h3>

<div class="overflow-x-auto">
<table class="w-full text-xs">
<thead>
<tr class="border-b uppercase text-slate-400 font-black">
<th class="text-left py-2">Data</th>
<th class="text-left">Mecz</th>
<th>Stawka</th>
<th>Kurs</th>
<th>Wynik</th>
<th class="text-right">Profit</th>
</tr>
</thead>
<tbody id="recent"></tbody>
</table>
</div>
</div>

<!-- LEAGUES -->
<div class="card">
<h3 class="text-xs font-black uppercase text-slate-400 mb-4">Wyniki wg lig</h3>
<div id="leagues" class="space-y-3"></div>
</div>

</div>

<script>
let STATS={}, HISTORY=[], chart=null;

function iconFor(l){
  if(l.includes('icehockey')) return 'üèí';
  if(l.includes('soccer')) return '‚öΩ';
  if(l.includes('basketball')) return 'üèÄ';
  if(l.includes('tennis')) return 'üéæ';
  return 'üéØ';
}

async function load(){
  const t='?'+Date.now();
  STATS=await (await fetch('stats.json'+t)).json();
  HISTORY=await (await fetch('history.json'+t)).json();
  renderStats(); renderChart(); renderRecent(); renderLeagues();
}

function renderStats(){
  document.getElementById('br').innerText=STATS.bankroll.toFixed(2)+' PLN';
  document.getElementById('pt').innerText=STATS.zysk_total.toFixed(2)+' PLN';
  document.getElementById('p24').innerText=STATS.zysk_24h.toFixed(2)+' PLN';
  document.getElementById('turn').innerText=STATS.obrot.toFixed(2)+' PLN';
  document.getElementById('yield').innerText=STATS.yield+'%';
  document.getElementById('active').innerText=STATS.upcoming_val;
  document.getElementById('count').innerText=HISTORY.length;
  document.getElementById('sync').innerText='Sync: '+STATS.last_sync;
}

function renderChart(){
  if(chart) chart.destroy();
  chart=new Chart(document.getElementById('chart'),{
    type:'line',
    data:{labels:STATS.history_graph.map((_,i)=>i),
      datasets:[{data:STATS.history_graph,borderWidth:3,tension:.4}]},
    options:{plugins:{legend:{display:false}},responsive:true}
  });
}

function renderRecent(){
  document.getElementById('recent').innerHTML=
  [...HISTORY].reverse().slice(0,12).map(m=>{
    const d=new Date(m.time);
    return `
<tr class="border-b hover:bg-slate-50">
<td class="py-2">${d.toLocaleDateString()}<br><span class="text-[10px] text-slate-400">${d.toLocaleTimeString().slice(0,5)}</span></td>
<td><b>${m.home} ‚Äì ${m.away}</b><br><span class="text-green-600 text-[10px] font-black">${m.winner||''}</span></td>
<td class="text-center">${m.stake}</td>
<td class="text-center">@${m.odds}</td>
<td class="text-center">${m.status==='WIN'?'‚úÖ':'‚ùå'}</td>
<td class="text-right font-black ${m.profit>=0?'text-green-600':'text-red-600'}">
${m.profit>=0?'+':''}${m.profit}
</td>
</tr>`;
  }).join('');
}

function renderLeagues(){
  const map={};
  HISTORY.forEach(m=>{
    if(!map[m.sport]) map[m.sport]={p:0,l:[]};
    map[m.sport].p+=m.profit; map[m.sport].l.push(m);
  });

  document.getElementById('leagues').innerHTML=
  Object.entries(map).sort((a,b)=>b[1].p-a[1].p).map(([l,d],i)=>`
<div class="border rounded-xl">
<div onclick="document.getElementById('lg${i}').classList.toggle('hidden')"
class="cursor-pointer flex justify-between p-4 bg-slate-50 hover:bg-slate-100">
<b>${iconFor(l)} ${l.replaceAll('_',' ')}</b>
<b class="${d.p>=0?'text-green-600':'text-red-600'}">${d.p>=0?'+':''}${d.p.toFixed(2)} PLN</b>
</div>
<div id="lg${i}" class="hidden px-4">
${d.l.map(m=>{
const d2=new Date(m.time);
return `<div class="py-2 border-b text-xs flex justify-between">
<div>
<b>${m.home} ‚Äì ${m.away}</b><br>
<span class="text-[10px] text-slate-400">${d2.toLocaleDateString()} ${d2.toLocaleTimeString().slice(0,5)} | stawka ${m.stake} | @${m.odds}</span><br>
<span class="text-green-600 font-black">${m.winner||''}</span>
</div>
<b class="${m.profit>=0?'text-green-600':'text-red-600'}">${m.profit>=0?'+':''}${m.profit}</b>
</div>`;
}).join('')}
</div>
</div>`).join('');
}

load();
</script>
</body>
</html>
