name: Bukmacher Bot Pro

on:
  schedule:
    # Skanowanie rynku co 3 godziny
    - cron: '0 0,3,6,9,12,15,18,21 * * *'
    # Raporty (07:00 rano to idealny czas na podsumowanie nocy i poprzedniego dnia)
    - cron: '0 7 * * *'
  workflow_dispatch:

permissions:
  contents: write

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: Install dependencies
        run: pip install requests python-dateutil

      - name: Run Bot Logic
        env:
          T_TOKEN: ${{ secrets.T_TOKEN }}
          T_CHAT: ${{ secrets.T_CHAT }}
          # ... reszta Twoich sekret√≥w
        run: |
          HOUR=$(date +%H)
          
          # 1. Zawsze rozliczamy mecze, ≈ºeby statystyki by≈Çy ≈õwie≈ºe
          python settle.py
          
          # 2. Logika raportowania i skanowania
          if [[ "$HOUR" == "07" ]]; then
              echo "üìä Generowanie raport√≥w okresowych..."
              # Wywo≈Çujemy stats.py z nowƒÖ flagƒÖ --auto
              python stats.py --auto
          fi
          
          # 3. Skanowanie rynku (niezale≈ºnie od raport√≥w)
          if [[ "$HOUR" -ge 23 || "$HOUR" -le 06 ]]; then
              python start.py --usa-only
          else
              python start.py
          fi

      - name: Push Database
        # ... (Twoja sekcja git push bez zmian, jest poprawna)
