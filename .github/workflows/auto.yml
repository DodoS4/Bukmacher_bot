import requests
import os
import json
from datetime import datetime, timedelta, timezone

# ================= KONFIGURACJA =================
T_TOKEN = os.getenv("T_TOKEN")
T_CHAT = os.getenv("T_CHAT")

# ObsÅ‚uga puli 5 kluczy API (Zgodnie z Twoim .yml)
KEYS_POOL = [os.getenv(f"ODDS_KEY{i}") for i in ["", "_2", "_3", "_4", "_5"]]
API_KEYS = [k for k in KEYS_POOL if k]

# --- PARAMETRY STAWEK (PLN) ---
STAKE_STANDARD = 50.0   # Kwota na zwykÅ‚y Double
STAKE_GOLDEN = 100.0    # Kwota na ZÅ‚oty Double (oba mecze â­)
TAX_RATE = 0.88         # Podatek 12% w Polsce

# --- FILTRY KURSÃ“W ---
MIN_SINGLE_ODD = 1.25   # Ochrona przed podatkiem
MAX_SINGLE_ODD = 1.60   # Maksymalny kurs dla faworyta
GOLDEN_MAX_ODD = 1.35   # Kurs powyÅ¼ej ktÃ³rego mecz nie jest "ZÅ‚oty"

# --- WYBRANE LIGI (NAJWYÅ»SZA PRZEWIDYWALNOÅšÄ†) ---
SPORTS_CONFIG = {
    "soccer_epl": "ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿ Premier League",
    "soccer_spain_la_liga": "ğŸ‡ªğŸ‡¸ La Liga",
    "soccer_germany_bundesliga": "ğŸ‡©ğŸ‡ª Bundesliga",
    "soccer_italy_serie_a": "ğŸ‡®ğŸ‡¹ Serie A",
    "soccer_france_ligue_one": "ğŸ‡«ğŸ‡· Ligue 1",
    "soccer_poland_ekstraklasa": "ğŸ‡µğŸ‡± Ekstraklasa",
    "soccer_uefa_champions_league": "ğŸ‡ªğŸ‡º Liga MistrzÃ³w",
    "basketball_nba": "ğŸ€ NBA",
}

STATE_FILE = "sent.json"

# ================= SYSTEM DANYCH =================

def load_data():
    """Wczytuje wysÅ‚ane mecze i naprawia bÅ‚Ä…d sÅ‚ownika jeÅ›li wystÄ…pi."""
    if not os.path.exists(STATE_FILE):
        return []
    try:
        with open(STATE_FILE, "r") as
