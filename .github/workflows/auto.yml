name: DEBUG-TEST-V3

on:
  workflow_dispatch: 

jobs:
  debug-job:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: Install Requests
        run: pip install requests

      - name: Run Test Script
        env:
          T_TOKEN: ${{ secrets.T_TOKEN }}
          T_CHAT: ${{ secrets.T_CHAT }}
        run: |
          cat << 'EOF' > final_test.py
          import os
          import requests

          def run_debug():
              token = os.environ.get("T_TOKEN")
              chat = os.environ.get("T_CHAT")
              
              print(f"DEBUG: Token obecny: {bool(token)}")
              print(f"DEBUG: Chat obecny: {bool(chat)}")

              msg_url = f"https://api.telegram.org/bot{token}/sendMessage"
              res = requests.post(msg_url, json={
                  "chat_id": chat,
                  "text": "ðŸš€ TEST V3: JeÅ›li to widzisz, to znaczy ze wszystko dziala!"
              }).json()
              
              if res.get("ok"):
                  print("SUKCES! Wiadomosc wyslana.")
              else:
                  print(f"BLAD TELEGRAMA: {res}")

          run_debug()
          EOF
          
          python final_test.py
